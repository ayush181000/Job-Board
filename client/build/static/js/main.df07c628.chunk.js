(this["webpackJsonpjob-board-client"]=this["webpackJsonpjob-board-client"]||[]).push([[0],{58:function(e,t,n){"use strict";n.r(t);n(46);var a=n(2),c=n(39),r=n.n(c),s=n(8),i=n(9),o=n(10),l=n(11),u=n(19),b=n(5),j=n(6),h=n(15),d="accessToken";function p(){return(p=Object(h.a)(Object(j.a)().mark((function e(t,n){var a,c,r;return Object(j.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://localhost:9000/login",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({email:t,password:n})});case 2:if(!(a=e.sent).ok){e.next=9;break}return e.next=6,a.json();case 6:c=e.sent,r=c.token,localStorage.setItem(d,r);case 9:return e.abrupt("return",a.ok);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(){return!!localStorage.getItem(d)}var m,v,f,x,y,g=n(1),N=function(e){Object(o.a)(n,e);var t=Object(l.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){var e=this.props.jobs;return Object(g.jsx)("ul",{className:"box",children:e.map(this.renderJob.bind(this))})}},{key:"renderJob",value:function(e){var t=e.company?"".concat(e.title," at ").concat(e.company.name):e.title;return Object(g.jsx)("li",{className:"media",children:Object(g.jsx)("div",{className:"media-content",children:Object(g.jsx)(u.b,{to:"/jobs/".concat(e.id),children:t})})},e.id)}}]),n}(a.Component),k=n(22),w=n(23),C=n(20),I=n(63),J=n(61),S=n(62),q=new C.a((function(e,t){return O()&&e.setContext({headers:{authorization:"Bearer "+localStorage.getItem(d)}}),t(e)})),D=new I.a({link:C.a.from([q,new J.a({uri:"http://localhost:9000/graphql"})]),cache:new S.a}),L=Object(w.a)(m||(m=Object(k.a)(["\n  fragment JobDetail on Job {\n    id\n    title\n    company {\n      id\n      name\n    }\n    description\n  }\n"]))),$=Object(w.a)(v||(v=Object(k.a)(["\n  mutation CreateJob($input: CreateJobInput) {\n    job: createJob(input: $input) {\n      ...JobDetail\n    }\n  }\n  ","\n"])),L),P=Object(w.a)(f||(f=Object(k.a)(["\n  query CompanyQuery($id: ID!) {\n    company(id: $id) {\n      id\n      name\n      description\n      jobs {\n        id\n        title\n      }\n    }\n  }\n"]))),Q=Object(w.a)(x||(x=Object(k.a)(["\n  query JobQuery($id: ID!) {\n    job(id: $id) {\n      ...JobDetail\n    }\n  }\n  ","\n"])),L),B=Object(w.a)(y||(y=Object(k.a)(["\n  query JobsQuery {\n    jobs {\n      id\n      title\n      company {\n        id\n        name\n      }\n    }\n  }\n"])));function M(){return(M=Object(h.a)(Object(j.a)().mark((function e(t){var n,a;return Object(j.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.mutate({mutation:$,variables:{input:t},update:function(e,t){var n=t.data;e.writeQuery({query:Q,variables:{id:n.job.id},data:n})}});case 2:return n=e.sent,a=n.data.job,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(e){return E.apply(this,arguments)}function E(){return(E=Object(h.a)(Object(j.a)().mark((function e(t){var n,a;return Object(j.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.query({query:P,variables:{id:t}});case 2:return n=e.sent,a=n.data.company,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function H(e){return z.apply(this,arguments)}function z(){return(z=Object(h.a)(Object(j.a)().mark((function e(t){var n,a;return Object(j.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.query({query:Q,variables:{id:t}});case 2:return n=e.sent,a=n.data.job,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(){return F.apply(this,arguments)}function F(){return(F=Object(h.a)(Object(j.a)().mark((function e(){var t,n;return Object(j.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.query({query:B,fetchPolicy:"no-cache"});case 2:return t=e.sent,n=t.data,e.abrupt("return",n.jobs);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var G=function(e){Object(o.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).state={company:null},a}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=Object(h.a)(Object(j.a)().mark((function e(){var t,n;return Object(j.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.match.params.companyId,e.next=3,T(t);case 3:n=e.sent,this.setState({company:n});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state.company;return e?Object(g.jsxs)("div",{children:[Object(g.jsx)("h1",{className:"title",children:e.name}),Object(g.jsx)("div",{className:"box",children:e.description}),Object(g.jsxs)("h5",{className:"title is-5",children:["Jobs at ",e.name]}),Object(g.jsx)(N,{jobs:e.jobs})]}):null}}]),n}(a.Component),K=n(30),R=function(e){Object(o.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).state={email:"",password:"",error:!1},a}return Object(i.a)(n,[{key:"handleChange",value:function(e){var t=e.target,n=t.name,a=t.value;this.setState(Object(K.a)({},n,a))}},{key:"handleClick",value:function(e){var t=this;e.preventDefault();var n=this.state;(function(e,t){return p.apply(this,arguments)})(n.email,n.password).then((function(e){e?t.props.onLogin():t.setState({error:!0})}))}},{key:"render",value:function(){var e=this.state,t=e.email,n=e.password,a=e.error;return Object(g.jsxs)("form",{children:[Object(g.jsxs)("div",{className:"field",children:[Object(g.jsx)("label",{className:"label",children:"Email"}),Object(g.jsx)("div",{className:"control",children:Object(g.jsx)("input",{className:"input",type:"text",name:"email",value:t,onChange:this.handleChange.bind(this)})})]}),Object(g.jsxs)("div",{className:"field",children:[Object(g.jsx)("label",{className:"label",children:"Password"}),Object(g.jsx)("div",{className:"control",children:Object(g.jsx)("input",{className:"input",type:"password",name:"password",value:n,onChange:this.handleChange.bind(this)})})]}),Object(g.jsxs)("div",{className:"field",children:[Object(g.jsx)("p",{className:"help is-danger",children:a&&"Invalid credentials"}),Object(g.jsx)("div",{className:"control",children:Object(g.jsx)("button",{className:"button is-link",onClick:this.handleClick.bind(this),children:"Login"})})]})]})}}]),n}(a.Component),U=function(e){Object(o.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).state={jobs:[]},a}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=Object(h.a)(Object(j.a)().mark((function e(){var t;return Object(j.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A();case 2:t=e.sent,this.setState({jobs:t});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state.jobs;return Object(g.jsxs)("div",{children:[Object(g.jsx)("h1",{className:"title",children:"Job Board"}),Object(g.jsx)(N,{jobs:e})]})}}]),n}(a.Component),V=function(e){Object(o.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).state={job:null},a}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=Object(h.a)(Object(j.a)().mark((function e(){var t,n;return Object(j.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.match.params.jobId,e.next=3,H(t);case 3:n=e.sent,console.log(n),this.setState({job:n});case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state.job;return e?Object(g.jsxs)("div",{children:[Object(g.jsx)("h1",{className:"title",children:e.title}),Object(g.jsx)("h2",{className:"subtitle",children:Object(g.jsx)(u.b,{to:"/companies/".concat(e.company.id),children:e.company.name})}),Object(g.jsx)("div",{className:"box",children:e.description})]}):null}}]),n}(a.Component),W=function(e){Object(o.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).state={title:"",description:""},a}return Object(i.a)(n,[{key:"handleChange",value:function(e){var t=e.target,n=t.name,a=t.value;this.setState(Object(K.a)({},n,a))}},{key:"handleClick",value:function(e){var t=this;e.preventDefault(),function(e){return M.apply(this,arguments)}(this.state).then((function(e){t.props.history.push("/jobs/".concat(e.id))}))}},{key:"render",value:function(){var e=this.state,t=e.title,n=e.description;return Object(g.jsxs)("div",{children:[Object(g.jsx)("h1",{className:"title",children:"New Job"}),Object(g.jsx)("div",{className:"box",children:Object(g.jsxs)("form",{children:[Object(g.jsxs)("div",{className:"field",children:[Object(g.jsx)("label",{className:"label",children:"Title"}),Object(g.jsx)("div",{className:"control",children:Object(g.jsx)("input",{className:"input",type:"text",name:"title",value:t,onChange:this.handleChange.bind(this)})})]}),Object(g.jsxs)("div",{className:"field",children:[Object(g.jsx)("label",{className:"label",children:"Description"}),Object(g.jsx)("div",{className:"control",children:Object(g.jsx)("textarea",{className:"input",style:{height:"10em"},name:"description",value:n,onChange:this.handleChange.bind(this)})})]}),Object(g.jsx)("div",{className:"field",children:Object(g.jsx)("div",{className:"control",children:Object(g.jsx)("button",{className:"button is-link",onClick:this.handleClick.bind(this),children:"Submit"})})})]})})]})}}]),n}(a.Component),X=function(e){Object(o.a)(n,e);var t=Object(l.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){var e=this.props,t=e.loggedIn,n=e.onLogout;return t?Object(g.jsx)("nav",{className:"navbar",children:Object(g.jsxs)("div",{className:"navbar-start",children:[Object(g.jsx)(u.b,{className:"navbar-item",to:"/",children:"Home"}),Object(g.jsx)(u.b,{className:"navbar-item",to:"/jobs/new",children:"Post Job"}),Object(g.jsx)("a",{className:"navbar-item",onClick:n,children:"Logout"})]})}):Object(g.jsx)("nav",{className:"navbar",children:Object(g.jsxs)("div",{className:"navbar-start",children:[Object(g.jsx)(u.b,{className:"navbar-item",to:"/",children:"Home"}),Object(g.jsx)(u.b,{className:"navbar-item",to:"/login",children:"Login"})]})})}}]),n}(a.Component),Y=function(e){Object(o.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).state={loggedIn:O()},a}return Object(i.a)(n,[{key:"handleLogin",value:function(){this.setState({loggedIn:!0}),this.router.history.push("/")}},{key:"handleLogout",value:function(){localStorage.removeItem(d),this.setState({loggedIn:!1}),this.router.history.push("/")}},{key:"render",value:function(){var e=this,t=this.state.loggedIn;return Object(g.jsx)(u.a,{ref:function(t){return e.router=t},children:Object(g.jsxs)("div",{children:[Object(g.jsx)(X,{loggedIn:t,onLogout:this.handleLogout.bind(this)}),Object(g.jsx)("section",{className:"section",children:Object(g.jsx)("div",{className:"container",children:Object(g.jsxs)(b.c,{children:[Object(g.jsx)(b.a,{exact:!0,path:"/",component:U}),Object(g.jsx)(b.a,{path:"/companies/:companyId",component:G}),Object(g.jsx)(b.a,{exact:!0,path:"/jobs/new",component:W}),Object(g.jsx)(b.a,{path:"/jobs/:jobId",component:V}),Object(g.jsx)(b.a,{exact:!0,path:"/login",render:function(){return Object(g.jsx)(R,{onLogin:e.handleLogin.bind(e)})}})]})})})]})})}}]),n}(a.Component);r.a.render(Object(g.jsx)(Y,{}),document.getElementById("root"))}},[[58,1,2]]]);
//# sourceMappingURL=main.df07c628.chunk.js.map